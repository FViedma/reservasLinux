window.BackendReportsApi=window.BackendReportsApi||{},function(e){e.getAppointmentsBySpecialities=function(e,t){var a=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_appointments_by_specialities",n={csrfToken:GlobalVariables.csrfToken,speciality_value:e,date_value:t};$.ajax({url:a,type:"GET",data:n,dataType:"json"}).done(function(e){e.length>0&&function(e){let t={};e.forEach(e=>{t.hasOwnProperty(e.speciality.name+" - "+e.doctor.last_name+" "+e.doctor.first_name)||(t[e.speciality.name+" - "+e.doctor.last_name+" "+e.doctor.first_name]={patients:[]}),t[e.speciality.name+" - "+e.doctor.last_name+" "+e.doctor.first_name].patients.push({name:e.patient.first_name,lastname:e.patient.last_name,clinical_story:e.patient.clinical_story,diagnostic:null==e.notes?"":e.notes,municipality:null==e.municipality?"":e.municipality,medical_center:null==e.medical_center?"":e.medical_center,doc_name:e.doctor.first_name,doc_last_name:e.doctor.last_name,start_datetime:e.start_datetime})});var a=new jsPDF("p","pt","letter");60,60;var n=30,i=30,s=40;Object.entries(t).forEach(([e,r])=>{a.setFont("helvetica"),a.setFontType("bold"),a.setFontSize(10),a.text(30,i,e),Object.entries(r).forEach(([e,t])=>{var i=t.length-1;t.forEach(e=>{if(a.setFont("courier"),a.setFontType("normal"),a.setFontSize(10),a.text(n,s,e.name+" "+e.lastname),a.text(n,s+10,e.clinical_story),a.text(n,s+20,e.start_datetime),a.text(n,s+30,e.diagnostic),a.text(n,s+40,e.municipality),a.text(n,s+50,e.medical_center),t.indexOf(e)<i){var r=n+200+5;r>552?(n=30,(s+=70)>=717&&(a.addPage(),s=30)):n=r}})}),nextYtittle=s,Object.entries(t).findIndex(t=>t.key===e)<Object.keys(t).length-1&&(nextYtittle>717?(a.addPage(),n=30,i=30,s=40):(i=s+=70,s+=10,n=30))});var r=a.output("bloburi");$(".preview-pane").attr("src",r)}(e)})},e.getAppointmentByCi=function(e,t){var a=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_appointment_by_ci",n={csrfToken:GlobalVariables.csrfToken,ci_value:e,complement_ci:t};$.ajax({url:a,type:"GET",data:n,dataType:"json"}).done(function(e){if(e.length>0&&"FAILURE"!=e){e=e[0],$("#appointment-message").empty();var t=e.customer.first_name+" "+e.customer.last_name,a=e.provider.first_name+" "+e.provider.last_name;$("#appointment-message").append(function(e,t,a,n,i,s,r){return $("<div/>",{class:"card",html:[$("<div/>",{class:"card-header bg-success",html:[$("<h5/>",{text:EALang.last_appointment})]}),$("<div/>",{class:"card-text",style:"white-space: pre-line;",text:"Paciente: "+e+"\nHistoria Clinica: "+s+"\nCI: "+t+"\nFecha reserva: "+a+"\nEspecialidad: "+n+"\nMedico: "+i+"\nDiagnóstico: "+r})]})}(t,e.customer.user_ci,e.start_datetime,e.service.name,a,e.customer.clinical_story,e.notes))}else $("#appointment-message").empty(),$("#appointment-message").append($("<div/>",{class:"card",html:[$("<div/>",{class:"card-header bg-error",html:[$("<h5/>",{text:EALang.patient_not_found})]}),$("<div/>",{class:"card-text",style:"white-space: pre-line;",text:"Paciente no tiene reserva para el presente día"})]}))})}}(window.BackendReportsApi);