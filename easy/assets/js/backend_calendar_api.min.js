window.BackendCalendarApi=window.BackendCalendarApi||{},function(a){"use strict";a.saveAppointment=function(a,e,n,t){var i=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_appointment",o={csrfToken:GlobalVariables.csrfToken,appointment_data:JSON.stringify(a)};e&&(o.customer_data=JSON.stringify(e)),$.post(i,o).done(function(a){n&&n(a)}).fail(function(a,e,n){t&&t()})},a.saveUnavailable=function(a,e,n){var t=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_unavailable",i={csrfToken:GlobalVariables.csrfToken,unavailable:JSON.stringify(a)};$.post(t,i).done(function(a){e&&e(a)}).fail(function(a,e,t){n&&n()})},a.saveWorkingPlanException=function(a,e,n,t,i){var o=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_save_working_plan_exception",l={csrfToken:GlobalVariables.csrfToken,date:a,working_plan_exception:e,provider_id:n};$.post(o,l).done(function(a){t&&t(a)}).fail(function(a,e,n){i&&i()})},a.deleteWorkingPlanException=function(a,e,n,t){var i=GlobalVariables.baseUrl+"/index.php/backend_api/ajax_delete_working_plan_exception",o={csrfToken:GlobalVariables.csrfToken,date:a,provider_id:e};$.post(i,o).done(function(a){n&&n(a)}).fail(function(a,e,n){t&&t()})},a.getPatientByCI=function(a,e){var n=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_patient_by_ci",t={patientCI:a,complement:e};$.ajax({url:n,type:"GET",data:t,dataType:"json"}).done(function(n){if(0==n.length)$("#form-message").empty(),$("#appointment-message").empty(),$("#save-appointment").prop("disabled",!0),GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_not_found);else if(n.length>0){var t=/[^0-9]+/,i=0;for(!function(a,e){var n=GlobalVariables.baseUrl+"/index.php/Backend_api/ajax_get_patient_reservation",t={patientCI:a,complement:e};$.ajax({url:n,type:"GET",data:t,dataType:"json"}).done(function(a){if(null==a)$("#appointment-message").empty(),GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_not_found);else if(a.length>=1){var a=a[0],e=new Date(a.book_datetime);(function(a,e){var n=!1,t=!1,i=!1;a.getFullYear()==a.getFullYear()&&(n=!0);a.getMonth()===e.getMonth()&&(t=!0);a.getDate()===e.getDate()&&(i=!0);return n==t&&t==i})(e,new Date)&&GeneralFunctions.displayMessageBox(EALang.message,EALang.patient_reserved_already+" "+a.book_datetime)}})}(a,e);i<n.length;){if(n[i].HCL_NUMCI.replace(t,"")==a){$("#first-name").val(n[i].HCL_NOMBRE),$("#last-name").val(n[i].HCL_APPAT+" "+n[i].HCL_APMAT),$("#clinical-story").val(n[i].HCL_CODIGO),$("#save-appointment").prop("disabled",!1);break}i++}}else $("#manage-appointment").find("#first-name, #last-name,#clinical-story").val("")})}}(window.BackendCalendarApi);